
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://rdkcentral.github.com/Thunder/plugin/messaging/">
      
      
        <link rel="prev" href="../versioning/">
      
      
        <link rel="next" href="../subsystems/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>Messaging - Thunder (WPEFramework)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tracing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Thunder (WPEFramework)" class="md-header__button md-logo" aria-label="Thunder (WPEFramework)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Thunder (WPEFramework)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Messaging
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/rdkcentral/Thunder/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    rdkcentral/Thunder
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Thunder (WPEFramework)" class="md-nav__button md-logo" aria-label="Thunder (WPEFramework)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Thunder (WPEFramework)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/rdkcentral/Thunder/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    rdkcentral/Thunder
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/intro/" class="md-nav__link">
        What is Thunder
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/repos/" class="md-nav__link">
        Repository Structure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/build_linux/" class="md-nav__link">
        Linux Build
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/build_windows/" class="md-nav__link">
        Windows Build
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/config/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/usage/" class="md-nav__link">
        Basic Usage
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          Architecture
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Architecture
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/architecture/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_3_2" id="__nav_2_3_2_label" tabindex="0">
          RPC Protocols
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3_2">
          <span class="md-nav__icon md-icon"></span>
          RPC Protocols
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/architecture/rpc/jsonrpc/" class="md-nav__link">
        JSON-RPC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/architecture/rpc/comrpc/" class="md-nav__link">
        COM-RPC
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Plugin Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Plugin Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../intro/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../execution-modes/" class="md-nav__link">
        Execution Modes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lifecycle/" class="md-nav__link">
        Plugin Lifecycle
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../principles/" class="md-nav__link">
        Design Principles
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
      
      
      
        <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
          Interfaces
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          Interfaces
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../interfaces/interfaces/" class="md-nav__link">
        Interface-Driven Development
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../interfaces/docs/" class="md-nav__link">
        Documentation generation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../errors/" class="md-nav__link">
        Error Handling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../versioning/" class="md-nav__link">
        Versioning
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Messaging
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../subsystems/" class="md-nav__link">
        Subsystems
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../proxypool/" class="md-nav__link">
        ProxyPool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../private-comrpc/" class="md-nav__link">
        Private COM-RPC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../split-implementation.md" class="md-nav__link">
        Split Implementation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../composite/" class="md-nav__link">
        Composite Plugins
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Common Utilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Common Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/strings/" class="md-nav__link">
        Strings
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          File Handling
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          File Handling
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/files/files/" class="md-nav__link">
        Filesystem Interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/files/observer/" class="md-nav__link">
        File Observer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/json/" class="md-nav__link">
        JSON Parser
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
          Threading
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Threading
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/threading/worker-pool/" class="md-nav__link">
        Worker Pool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/threading/mutex/" class="md-nav__link">
        Mutexes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/timers/" class="md-nav__link">
        Timers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/web/" class="md-nav__link">
        Web Requests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/networking/" class="md-nav__link">
        Network Sockets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/processes/" class="md-nav__link">
        Processes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Client Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Client Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../client/intro/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../client/json-rpc/" class="md-nav__link">
        JSON-RPC App
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../client/com-rpc/" class="md-nav__link">
        COM-RPC App
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Debugging
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Debugging
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debugging/debug/" class="md-nav__link">
        Debug Tips
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debugging/thundershark/" class="md-nav__link">
        ThunderShark
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Walkthrough
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Walkthrough
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
      
      
      
        <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
          Hello World
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Hello World
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../walkthrough/hello-world/setup/" class="md-nav__link">
        Workspace setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../walkthrough/hello-world/guide/" class="md-nav__link">
        Plugin development
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_3" >
      
      
      
        <label class="md-nav__link" for="__nav_7_1_3" id="__nav_7_1_3_label" tabindex="0">
          Client development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_1_3">
          <span class="md-nav__icon md-icon"></span>
          Client development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../walkthrough/hello-world/client-jsonrpc/" class="md-nav__link">
        JSON-RPC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../walkthrough/hello-world/client-comrpc/" class="md-nav__link">
        COM-RPC
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Misc
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Misc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/" class="md-nav__link">
        Documentation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<p>In the past, logging, tracing and warning reporting were completely separate issues and were handled individually. However, even though these message types have distinct characteristics, we recognized the advantages of consolidating them into a unified framework, which is now referred to as <code>Messaging</code>. We are convinced it is much better suited for the development, and with some recent fixes that will be described in the following sections, <code>Messaging</code> is fully operational. We strongly believe that it is a good time to shed some more light on that functionality, since it is simple to use and yet very effective.</p>
<p>Before we begin to describe what the <code>MessageControl</code> plugin does and where logging, tracing and warning reporting can be directed, it is probably a good idea to start from the ground up. In this case, what precisely are these message types, what are their differences in general and in Thunder, how exactly the messages are created, and what is going on with them before they end up at their final destination.</p>
<p>We can all agree that logging, tracing and warning reporting are important techniques often used in software development to gather information and provide insight into the behavior of an application. However, there are some fundamental differences between them.</p>
<h1 id="tracing">Tracing</h1>
<p>First, let us briefly discuss the part responsible for the tracing. In theory, tracing is the process of monitoring the flow of a request through an application. It is used to identify performance bottlenecks and understand the interactions between different components of a distributed system. A trace typically consists of a series of events, each of which corresponds to a particular stage in the processing of a request. Tracing provides a much broader and more continuous perspective of the application compared to logging. The goal of tracing is to track the flow and evolution of data within a program so that we can be proactive instead of just reactive and increase overall performance.</p>
<div class="highlight"><pre><span></span><code><span class="n">TRACE</span><span class="p">(</span><span class="n">Trace</span><span class="o">::</span><span class="n">Information</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">&quot;Not an A2DP audio sink device!&quot;</span><span class="p">)));</span>

<span class="n">TRACE_GLOBAL</span><span class="p">(</span><span class="n">Trace</span><span class="o">::</span><span class="n">Error</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Is this not a descriptor to a DRM Node... =^..^= &quot;</span><span class="p">));</span>
</code></pre></div>
<p>In Thunder, there are two main macros that can be used to wrap messages that will be treated as traces. These macros, namely <code>TRACE</code> and <code>TRACE_GLOBAL</code>, can be found in <code>Thunder/Source/messaging/TraceControl.h</code>. Upon examining the code, we can notice that the only distinction between them is that <code>TRACE</code> includes the class name where it is used, whereas the global version refers to the function name instead of a class.</p>
<div class="highlight"><pre><span></span><code><span class="n">TRACE_L1</span><span class="p">(</span><span class="s">&quot;Failed to load library: %s, error %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">_error</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
</code></pre></div>
<p>On a side note, if you browse the Thunder code, you may come across another macro called <code>TRACE_L1</code>. You might wonder how it differs from the previously mentioned macros. To understand its purpose, it is important to know that tracing is disabled in certain layers of Thunder. This is necessary because <code>Messaging</code> relies on both <code>COM</code> and <code>Core</code>, and we surely want to avoid circular dependencies. As a result, <code>TRACE_L1</code> is restricted to lower layers only. Within the framework, you can utilize it in <code>Core</code> and <code>Messaging</code>, but it should not be used in <code>COM</code>. Moreover, once you reach a certain point, refrain from using <code>TRACE_L1</code> altogether, and instead use the <code>TRACE</code> macro.</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define TRACE(CATEGORY, PARAMETERS)</span>
<span class="w">    </span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">using</span><span class="w"> </span><span class="n">__control__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRACE_CONTROL</span><span class="p">(</span><span class="n">CATEGORY</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">__control__</span><span class="o">::</span><span class="n">IsEnabled</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">CATEGORY</span><span class="w"> </span><span class="n">__data__</span><span class="w"> </span><span class="n">PARAMETERS</span><span class="p">;</span>
<span class="w">            </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="w"> </span><span class="nf">__info__</span><span class="p">(</span>
<span class="w">                </span><span class="n">__control__</span><span class="o">::</span><span class="n">Metadata</span><span class="p">(),</span>
<span class="w">                </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Time</span><span class="o">::</span><span class="n">Now</span><span class="p">().</span><span class="n">Ticks</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">            </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">IStore</span><span class="o">::</span><span class="n">Tracing</span><span class="w"> </span><span class="nf">__trace__</span><span class="p">(</span>
<span class="w">                </span><span class="n">__info__</span><span class="p">,</span>
<span class="w">                </span><span class="n">__FILE__</span><span class="p">,</span>
<span class="w">                </span><span class="n">__LINE__</span><span class="p">,</span>
<span class="w">                </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">ClassNameOnly</span><span class="p">(</span><span class="k">typeid</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">).</span><span class="n">name</span><span class="p">()).</span><span class="n">Text</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">            </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">TextMessage</span><span class="w"> </span><span class="nf">__message__</span><span class="p">(</span><span class="n">__data__</span><span class="p">.</span><span class="n">Data</span><span class="p">());</span>
<span class="w">            </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageUnit</span><span class="o">::</span><span class="n">Instance</span><span class="p">().</span><span class="n">Push</span><span class="p">(</span><span class="n">__trace__</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">__message__</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span>
</code></pre></div>
<p>In the code fragment above, you can observe the internal structure of the macro. While more detailed explanations will be provided in subsequent paragraphs, let us cover the general process briefly. Firstly, we need to verify if the corresponding category is enabled. If it is, we proceed to create metadata for the message and send it alongside the message itself to the plugin, which will be discussed in greater detail in the plugin section. Before continuing, it is also worth noting that there is a way to print the trace messages directly on the console in case the <code>MessageControl</code> plugin is disabled. In such a situation, the <code>Output()</code> method of the <code>DirectOutput</code> class can be used, but this will be described further on in the following section.</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">DirectOutput::Output</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="o">&amp;</span><span class="w"> </span><span class="n">messageInfo</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">IEvent</span><span class="o">*</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="k">const</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">ASSERT</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
<span class="w">    </span><span class="n">ASSERT</span><span class="p">(</span><span class="n">messageInfo</span><span class="p">.</span><span class="n">Type</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">Metadata</span><span class="o">::</span><span class="n">type</span><span class="o">::</span><span class="n">INVALID</span><span class="p">);</span>

<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">messageInfo</span><span class="p">.</span><span class="n">ToString</span><span class="p">(</span><span class="n">_abbreviate</span><span class="p">).</span><span class="n">c_str</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">                    </span><span class="n">Core</span><span class="o">::</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="o">-&gt;</span><span class="n">Data</span><span class="p">().</span><span class="n">c_str</span><span class="p">());</span>

<span class="cp">#ifndef __WINDOWS__</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_isSyslog</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//use longer messages for syslog</span>
<span class="w">        </span><span class="n">syslog</span><span class="p">(</span><span class="n">LOG_NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span>
<span class="cp">#endif</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h1 id="logging">Logging</h1>
<p>Logging, on the other hand, is the process of recording events that occur during the execution of an application. These events could be error messages, warnings, or informational messages that provide details about the applicationâ€™s behavior. Logging is typically used for debugging and troubleshooting purposes. The primary goal of logging is to provide a historical record of events that can be used to analyze and diagnose problems. This means that in theory, we want to save the logs for later use.</p>
<div class="highlight"><pre><span></span><code><span class="n">SYSLOG</span><span class="p">(</span><span class="n">Logging</span><span class="o">::</span><span class="n">Startup</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">&quot;Failure in setting Key:Value:[%s]:[%s]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">index</span><span class="p">.</span><span class="n">Current</span><span class="p">().</span><span class="n">Key</span><span class="p">.</span><span class="n">Value</span><span class="p">().</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="n">index</span><span class="p">.</span><span class="n">Current</span><span class="p">().</span><span class="n">Value</span><span class="p">.</span><span class="n">Value</span><span class="p">().</span><span class="n">c_str</span><span class="p">()));</span>
</code></pre></div>
<p>This relates to the main difference between the <code>TRACE</code> and <code>SYSLOG</code> macros in Thunder, which is that <code>SYSLOG</code> is present in any build, and <code>TRACE</code> is dropped in production, the same way as, for example, an <code>ASSERT</code> macro. It concludes the main distinction between these two message categories in Thunder: tracing should be used when we want to indicate a vital information during the development, and we should use logging to record any important data that could be useful in the future.</p>
<div class="highlight"><pre><span></span><code><span class="n">SYSLOG_GLOBAL</span><span class="p">(</span><span class="n">Logging</span><span class="o">::</span><span class="n">Fatal</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">&quot;Plugin config file [%s] could not be opened.&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">file</span><span class="p">.</span><span class="n">Name</span><span class="p">().</span><span class="n">c_str</span><span class="p">()));</span>
</code></pre></div>
<p>Similarly as in the case of tracing, there is also a global version of the <code>SYSLOG</code> macro, and the difference is exactly the same as with tracing macros. Furthermore, the <code>DirectOutput</code> class can be configured using the <code>Mode()</code> method to send the messages to the system logger instead of simply printing them on the console.</p>
<p>In the piece of code below we can see that the first noticeable difference between tracing and logging macros is that there is an assert which ensures that the macro parameter <code>CATEGORY</code> is an actual logging category, so there is no way to create a custom logging category, unlike in the case of tracing or warning reporting. Apart from this difference, everything looks very similar besides the omission of file, line and class name, since these are not particularly useful when it comes to logging.</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define SYSLOG(CATEGORY, PARAMETERS)</span>
<span class="w">    </span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">static_assert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">is_base_of</span><span class="o">&lt;</span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Logging</span><span class="o">::</span><span class="n">BaseLoggingType</span><span class="o">&lt;</span><span class="n">CATEGORY</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">CATEGORY</span><span class="o">&gt;::</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SYSLOG() only for Logging controls&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">CATEGORY</span><span class="o">::</span><span class="n">IsEnabled</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">CATEGORY</span><span class="w"> </span><span class="n">__data__</span><span class="w"> </span><span class="n">PARAMETERS</span><span class="p">;</span>
<span class="w">            </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="w"> </span><span class="nf">__info__</span><span class="p">(</span>
<span class="w">                </span><span class="n">CATEGORY</span><span class="o">::</span><span class="n">Metadata</span><span class="p">(),</span>
<span class="w">                </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Time</span><span class="o">::</span><span class="n">Now</span><span class="p">().</span><span class="n">Ticks</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">            </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">IStore</span><span class="o">::</span><span class="n">Logging</span><span class="w"> </span><span class="nf">__log__</span><span class="p">(</span><span class="n">__info__</span><span class="p">);</span>
<span class="w">            </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">TextMessage</span><span class="w"> </span><span class="nf">__message__</span><span class="p">(</span><span class="n">__data__</span><span class="p">.</span><span class="n">Data</span><span class="p">());</span>
<span class="w">            </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageUnit</span><span class="o">::</span><span class="n">Instance</span><span class="p">().</span><span class="n">Push</span><span class="p">(</span><span class="n">__log__</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">__message__</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span>
</code></pre></div>
<p>In addition, you might be wondering why we have some <code>Messaging</code> components such as <code>Metadata</code> in <code>Core</code>, and why everything is not simply inside
<code>Source/messaging</code>. From an architectural point of view, there is a reason for this, which revolves around the need for reporting capabilities within <code>Core</code>. For instance, we would like to measure how long it takes to lock and then unlock. To accomplish this, we need some of the messaging features to be accessible in <code>Core</code>, because otherwise we would get, as you may have guessed, circular dependencies.</p>
<h1 id="warning-reporting">Warning Reporting</h1>
<p>Last but not least, it is about time to describe warning reporting. It is a crucial aspect of software systems that aims to alert developers and users about potential issues or anomalies within the system's operation. Unlike logging and tracing, which primarily focus on capturing and storing detailed information for diagnostic purposes, warning reporting specifically targets situations where certain conditions might lead to unexpected behavior or errors. While logging records events and activities to provide a comprehensive record of system activity, and tracing follows the flow of execution across different components or services, warning reporting is designed to raise flags about specific conditions that could lead to failures, performance degradation, or security vulnerabilities.</p>
<p>By emphasizing the significance of these conditions, warning reporting enables proactive identification and resolution of potential problems, enhancing system reliability and user experience. It acts as an early detection mechanism, signaling the need for attention and potential action before the situation escalates into a critical failure or incident. Overall, warning reporting complements logging and tracing by focusing on identifying and communicating conditions that require immediate attention, facilitating effective troubleshooting and maintenance of software systems.</p>
<div class="highlight"><pre><span></span><code><span class="n">REPORT_OUTOFBOUNDS_WARNING</span><span class="p">(</span><span class="n">WarningReporting</span><span class="o">::</span><span class="n">SinkStillHasReference</span><span class="p">,</span><span class="w"> </span><span class="n">_referenceCount</span><span class="p">);</span>
</code></pre></div>
<h2 id="macros">Macros</h2>
<p>Within Thunder, there are five distinct macros dedicated to warning reporting, each with a slightly different use case scenario. You can find these macros inside <code>Source/core/WarningReportingControl.h</code>. The first two macros, <code>REPORT_WARNING</code> and <code>REPORT_WARNING_GLOBAL</code>, only require the <code>CATEGORY</code> parameter. These macros should be used when reporting a warning without without specific values within the category. While all categories in Thunder currently use actual values and compare them with the reporting bounds. While all categories in Thunder currently utilize actual values and compare them against reporting bounds, these macros have been implemented with future use cases in mind. If someone decides to add their own simple category without reporting values, they can effortlessly make use of these macros.</p>
<p>The following two macros, namely <code>REPORT_OUTOFBOUNDS_WARNING</code> and <code>REPORT_OUTOFBOUNDS_WARNING_EX</code>, serve a different purpose compared to the macros described in the previous paragraph. As their names suggest, these macros are utilized when we want to generate a warning only if a specific parameter value exceeds the defined reporting bound. To provide a clearer understanding, let us examine an example code snippet. Please note that for improved readability, the majority of the namespace has been intentionally omitted, and the <code>REPORT_OUTOFBOUNDS_WARNING_EX</code> macro includes an additional user-provided callsign parameter.</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define REPORT_OUTOFBOUNDS_WARNING(CATEGORY, ACTUALVALUE, ...)</span>
<span class="w">    </span><span class="k">if</span><span class="p">(...</span><span class="n">WarningReportingType</span><span class="o">&lt;</span><span class="p">...</span><span class="n">WarningReportingBoundsCategory</span><span class="o">&lt;</span><span class="n">CATEGORY</span><span class="o">&gt;&gt;::</span><span class="n">IsEnabled</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">...</span><span class="n">WarningReportingType</span><span class="o">&lt;</span><span class="p">...</span><span class="n">WarningReportingBoundsCategory</span><span class="o">&lt;</span><span class="n">CATEGORY</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">__message__</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">__message__</span><span class="p">.</span><span class="n">Analyze</span><span class="p">(...</span><span class="n">MODULE_NAME</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="n">Callsign</span><span class="p">(),</span><span class="w"> </span><span class="n">ACTUALVALUE</span><span class="p">,</span><span class="w"> </span><span class="err">##</span><span class="n">__VA_ARGS__</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="p">...</span><span class="n">WarningReportingUnitProxy</span><span class="o">::</span><span class="n">Instance</span><span class="p">().</span><span class="n">ReportWarningEvent</span><span class="p">(</span>
<span class="w">                </span><span class="p">...</span><span class="n">CallsignAccess</span><span class="o">&lt;&amp;</span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">System</span><span class="o">::</span><span class="n">MODULE_NAME</span><span class="o">&gt;::</span><span class="n">Callsign</span><span class="p">(),</span>
<span class="w">                    </span><span class="n">__message__</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>The initial section is identical across all macros, including warning reporting, tracing, and logging. It begins by verifying if the corresponding category is enabled. It's important to note that in Thunder, the tracing categories are disabled by default, while all logging and warning reporting categories are enabled. However, these settings can be modified either through the ThunderUI or the configuration options, which will be explained further in the upcoming paragraph.</p>
<p>Returning to the provided code snippet, we observe that if the category is enabled, an object is created, and the <code>Analyze()</code> method is invoked. This represents the primary distinction between the warning reporting macros and those used for tracing and logging.</p>
<div class="highlight"><pre><span></span><code><span class="n">templatec</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">Args</span><span class="o">&gt;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">Analyze</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">moduleName</span><span class="p">[],</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">identifier</span><span class="p">[],</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">actualValue</span><span class="p">,</span><span class="w"> </span><span class="n">Args</span><span class="o">&amp;&amp;</span><span class="p">...</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span><span class="n">_actualValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actualValue</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">actualValue</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">_reportingBound</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">memory_order_relaxed</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">report</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CallAnalyze</span><span class="p">(</span><span class="n">moduleName</span><span class="p">,</span><span class="w"> </span><span class="n">identifier</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">forward</span><span class="o">&lt;</span><span class="n">Args</span><span class="o">&gt;</span><span class="p">(</span><span class="n">args</span><span class="p">)...);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">report</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>In the code above, we can notice that the main job of this method is to check whether the <code>actualValue</code> reported by the macro exceeds the <code>_reportingBound</code> set by the user.  If the condition is met, then the <code>CallAnalyze()</code> method is called, which will invoke an <code>Analyze()</code> method specific to the warning reporting category. However, if the category does not have such a method, then <code>CallAnalyze()</code> simply returns <code>true</code>. In such fashion, we can easily check additional conditions necessary for a warning to trigger.</p>
<h2 id="warning-reporting-proxy">Warning Reporting proxy</h2>
<p>Moving forward, the next step involves sending the message to a proxy called <code>WarningReportingUnit</code>. This distinction highlights one of the key differences between warning reporting and other message types. While warning reporting can be used in <code>Core</code>, which is dependent on <code>messaging</code>, it necessitated the creation of a proxy to enable the use of warning reporting macros in <code>Core</code> while still routing the messages to <code>MessageUnit</code> located in <code>Source/messaging</code>. This entire process is accomplished through the utilization of the <code>ReportWarningEvent()</code> method:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">WarningReportingUnit::ReportWarningEvent</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">identifier</span><span class="p">[],</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">IWarningEvent</span><span class="o">&amp;</span><span class="w"> </span><span class="n">information</span><span class="p">)</span>
<span class="p">{</span><span class="w">        </span>
<span class="w">    </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">Metadata</span><span class="w"> </span><span class="n">metadata</span><span class="p">(</span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">Metadata</span><span class="o">::</span><span class="n">type</span><span class="o">::</span><span class="n">REPORTING</span><span class="p">,</span>
<span class="w">                                                     </span><span class="n">information</span><span class="p">.</span><span class="n">Category</span><span class="p">(),</span><span class="w"> </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MODULE_REPORTING</span><span class="p">);</span>
<span class="w">    </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="w"> </span><span class="n">messageInfo</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Time</span><span class="o">::</span><span class="n">Now</span><span class="p">().</span><span class="n">Ticks</span><span class="p">());</span>
<span class="w">    </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">IStore</span><span class="o">::</span><span class="n">WarningReporting</span><span class="w"> </span><span class="n">report</span><span class="p">(</span><span class="n">messageInfo</span><span class="p">,</span><span class="w"> </span><span class="n">identifier</span><span class="p">);</span>

<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">text</span><span class="p">;</span>
<span class="w">    </span><span class="n">information</span><span class="p">.</span><span class="n">ToString</span><span class="p">(</span><span class="n">text</span><span class="p">);</span>
<span class="w">    </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">TextMessage</span><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">text</span><span class="p">);</span>

<span class="w">    </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageUnit</span><span class="o">::</span><span class="n">Instance</span><span class="p">().</span><span class="n">Push</span><span class="p">(</span><span class="n">report</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">data</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>The code above is very similar to the one that can be found directly in tracing and logging macros, but for warning reporting the functionality of sending messages through the <code>Push()</code> method of <code>MessageUnit</code> has to be outside of the <code>Core</code>.</p>
<p>In tracing and logging macros, the user directly enters the message as a macro parameter. However, this differs for warning reporting. As shown in the provided code snippet, the actual message content is obtained from the <code>ToString()</code> method. This method needs to be implemented in each warning reporting category class and should return the desired string to be printed when a warning occurs.</p>
<p>The <code>REPORT_DURATION_WARNING</code> macro, as its name implies, serves the purpose of measuring the execution time of a specific code segment and generating a warning if the duration exceeds the expected threshold. In the provided code snippet, we observe a key distinction compared to the previous macros: the first parameter of the macro represents the code segment to be measured, and the timing is captured prior to invoking <code>Analyze()</code>. It is important to note that even if warning reporting is not enabled in the code or if a specific category provided as a parameter is not enabled, this code segment will still be executed.</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define REPORT_DURATION_WARNING(CODE, CATEGORY, ...)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(...</span><span class="n">WarningReportingType</span><span class="o">&lt;</span><span class="p">...</span><span class="n">WarningReportingBoundsCategory</span><span class="o">&lt;</span><span class="n">CATEGORY</span><span class="o">&gt;&gt;::</span><span class="n">IsEnabled</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Time</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Time</span><span class="o">::</span><span class="n">Now</span><span class="p">();</span>
<span class="w">        </span><span class="n">CODE</span>
<span class="w">        </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">duration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">uint32_t</span><span class="o">&gt;</span><span class="p">((</span><span class="n">Core</span><span class="o">::</span><span class="n">Time</span><span class="o">::</span><span class="n">Now</span><span class="p">().</span><span class="n">Ticks</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="p">.</span><span class="n">Ticks</span><span class="p">())</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Time</span><span class="o">::</span><span class="n">TicksPerMillisecond</span><span class="p">);</span>
<span class="w">        </span><span class="p">...</span><span class="n">WarningReportingType</span><span class="o">&lt;</span><span class="p">...</span><span class="n">WarningReportingBoundsCategory</span><span class="o">&lt;</span><span class="n">CATEGORY</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">__message__</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">__message__</span><span class="p">.</span><span class="n">Analyze</span><span class="p">(</span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">System</span><span class="o">::</span><span class="n">MODULE_NAME</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="n">CallsignAccess</span><span class="o">&lt;&amp;</span><span class="p">...</span><span class="n">MODULE_NAME</span><span class="o">&gt;::</span><span class="n">Callsign</span><span class="p">(),</span>
<span class="w">                                </span><span class="n">duration</span><span class="p">,</span><span class="w"> </span><span class="err">##</span><span class="n">__VA_ARGS__</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="p">...</span><span class="n">WarningReportingUnitProxy</span><span class="o">::</span><span class="n">Instance</span><span class="p">().</span><span class="n">ReportWarningEvent</span><span class="p">(</span>
<span class="w">                </span><span class="p">...</span><span class="n">CallsignAccess</span><span class="o">&lt;&amp;</span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">System</span><span class="o">::</span><span class="n">MODULE_NAME</span><span class="o">&gt;::</span><span class="n">Callsign</span><span class="p">(),</span><span class="n">__message__</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">CODE</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>The inclusion of the <code>REPORT_DURATION_WARNING</code> macro facilitates the efficient monitoring of code execution times and allows for the prompt identification of potential performance issues. By incorporating this macro at strategic points in the code, developers can gain valuable insights into the duration of specific code segments and receive warnings when execution times exceed the defined thresholds.</p>
<p>Even though it is nice to learn some theory of how things work, it is probably best to learn in practice and from examples, so before moving to the next paragraph, let us have a quick look at a piece of code in which the warning reporting macro is actually utilized. The code fragment below can be found in <code>Source/core/WorkerPool.h</code>, and the idea behind this reporting is to automatically trigger a warning in case a job has been dispatched for way too long.</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">AnalyseAndReportDispatchedJobs</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_lock</span><span class="p">.</span><span class="n">Lock</span><span class="p">();</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_dispatchedJobList</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">IsActive</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">job</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">_dispatchedJobList</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="o">++</span><span class="n">job</span><span class="p">.</span><span class="n">ReportRunCount</span><span class="p">;</span>
<span class="w">            </span><span class="n">REPORT_OUTOFBOUNDS_WARNING_EX</span><span class="p">(</span><span class="n">WarningReporting</span><span class="o">::</span><span class="n">JobActiveForTooLong</span><span class="p">,</span><span class="w"> </span><span class="n">job</span><span class="p">.</span><span class="n">CallSign</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span>
<span class="w">            </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">uint32_t</span><span class="o">&gt;</span><span class="p">((</span><span class="n">Time</span><span class="o">::</span><span class="n">Now</span><span class="p">().</span><span class="n">Ticks</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">job</span><span class="p">.</span><span class="n">DispatchedTime</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Time</span><span class="o">::</span><span class="n">TicksPerMillisecond</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">_lock</span><span class="p">.</span><span class="n">Unlock</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<h1 id="messagecontrol-plugin">MessageControl plugin</h1>
<p>Now that we have explored the concepts of logging, tracing, and warning reporting in theory and their implementation within Thunder, we can delve into the significance of the <code>MessageControl</code> plugin. This plugin plays a vital role as it manages all message types seamlessly. In the subsequent sections, we will provide a more detailed explanation of how the plugin operates and the specific steps it undertakes. However, it is important to highlight that the plugin not only consolidates various message types but also offers the flexibility to direct these messages to different specific outputs. These outputs include the Console, Syslog, a file, or even a Network Stream through UDP.</p>
<h2 id="content-of-the-message">Content of the message</h2>
<p>Before examining the workings of the plugin, it is crucial to provide a brief overview of the components that make up a message, as they directly impact the message processing. A message consists of three main parameters: module, category, and the actual content of the message. Understanding these parameters is essential for effective message handling.</p>
<h3 id="categories-of-each-message-type">Categories of each message type</h3>
<p>When it comes to tracing, the module parameter represents the name of the plugin responsible for sending the message, for example <code>Plugin_Cobalt</code>. However, when the <code>SYSLOG</code> macro is used, the module name will simply be <code>Syslog</code>.</p>
<p>Choosing the appropriate category is vital when working with macros. The category can be described as the class that either formats the message string or best represents the nature of the message. While it is possible to create custom categories, which will be explained in the following paragraph, it is generally recommended to utilize the predefined categories available in Thunder to avoid redundancy. Thunder already offers six default categories for tracing:</p>
<ul>
<li>
<p>Text</p>
</li>
<li>
<p>Initialization</p>
</li>
<li>
<p>Information</p>
</li>
<li>
<p>Warning</p>
</li>
<li>
<p>Error</p>
</li>
<li>
<p>Fatal</p>
</li>
</ul>
<p>Each of them is created in <code>Thunder/Source/messaging/TraceCategories.h</code> using the <code>DEFINE_MESSAGING_CATEGORY</code> macro:</p>
<div class="highlight"><pre><span></span><code><span class="n">DEFINE_MESSAGING_CATEGORY</span><span class="p">(</span><span class="n">Messaging</span><span class="o">::</span><span class="n">BaseCategoryType</span><span class="o">&lt;</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">Metadata</span><span class="o">::</span><span class="n">type</span><span class="o">::</span><span class="n">TRACING</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Text</span><span class="p">);</span>
</code></pre></div>
<p>As you can see in the code, these classes inherit from a templated class called <code>BaseCategoryType</code>. The association of these categories with tracing is established by passing the <code>TRACING</code> metadata type as a template parameter. Similarly, logging includes several categories, such as:</p>
<ul>
<li>
<p>Startup</p>
</li>
<li>
<p>Shutdown</p>
</li>
<li>
<p>Notification</p>
</li>
<li>
<p>Error</p>
</li>
<li>
<p>ParsingError</p>
</li>
<li>
<p>Fatal</p>
</li>
<li>
<p>Crash</p>
</li>
</ul>
<p>These logging categories are created using the <code>DEFINE_LOGGING_CATEGORY</code> macro defined in <code>Thunder/Source/messaging/LoggingCategories.h</code>. The process of establishing these categories is slightly more complex and involves the utilization of the mentioned macro.</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define DEFINE_LOGGING_CATEGORY(CATEGORY)</span>
<span class="w">    </span><span class="n">DEFINE_MESSAGING_CATEGORY</span><span class="p">(</span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Logging</span><span class="o">::</span><span class="n">BaseLoggingType</span><span class="o">&lt;</span><span class="n">CATEGORY</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">CATEGORY</span><span class="p">)</span>
<span class="w">    </span><span class="k">template</span><span class="o">&lt;&gt;</span>
<span class="w">    </span><span class="n">EXTERNAL</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="p">...</span><span class="n">BaseLoggingType</span><span class="o">&lt;</span><span class="n">CATEGORY</span><span class="o">&gt;::</span><span class="n">Control</span><span class="w"> </span><span class="p">...</span><span class="n">BaseLoggingType</span><span class="o">&lt;</span><span class="n">CATEGORY</span><span class="o">&gt;::</span><span class="n">_control</span><span class="p">;</span>
</code></pre></div>
<p>The <code>DEFINE_LOGGING_CATEGORY</code> macro functions by invoking the <code>DEFINE_MESSAGING_CATEGORY</code> macro. However, in this case, the classes created inherit from the templated class <code>BaseLoggingType</code>. The definition of this class can be found directly above the macro definition. Notably, the <code>BaseLoggingType</code> class itself inherits from the <code>BaseCategoryType</code> class, with the <code>LOGGING</code> metadata type passed as a template parameter.</p>
<p>Furthermore, Thunder allows for the creation of customized categories within plugins by simply creating classes within the <code>Tracing</code> namespace that handle message formatting. An example of this can be found in <code>ThunderNanoServices/BluetoothControl/Tracing.h</code>.</p>
<p>Last but not least, the warning reporting categories in Thunder can be found in either <code>Source/WPEFramework/WarningReportingCategories.h</code> or <code>Source/core/WarningReportingCategories.h</code>. These categories, located within the <code>WPEFramework::WarningReporting</code> namespace, include:</p>
<ul>
<li>TooLongWaitingForLock</li>
<li>SinkStillHasReference</li>
<li>TooLongInvokeRPC</li>
<li>JobTooLongToFinish</li>
<li>JobTooLongWaitingInQueue</li>
<li>TooLongDecrypt</li>
<li>JobActiveForTooLong</li>
<li>TooLongPluginState</li>
<li>TooLongInvokeMessage</li>
</ul>
<h3 id="creating-a-warning-reporting-category">Creating a warning reporting category</h3>
<p>Unlike the tracing and logging categories, these warning reporting categories are not declared using macros. Instead, they are directly declared within the designated header files mentioned above.</p>
<p>The code snippet below demonstrates the simplicity of creating a custom warning reporting category. If an additional <code>Analyze()</code> method is not necessary, it is sufficient to declare the <code>Serialize()</code> and <code>Deserialize()</code> methods to return <code>0</code>. However, attention must be given to the implementation of the <code>ToString()</code> method, along with the variables <code>DefaultWarningBound</code> and <code>DefaultReportBound</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">EXTERNAL</span><span class="w"> </span><span class="n">TooLongWaitingForLock</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">TooLongWaitingForLock</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">TooLongWaitingForLock</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>
<span class="w">    </span><span class="n">TooLongWaitingForLock</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">TooLongWaitingForLock</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>
<span class="w">    </span><span class="n">TooLongWaitingForLock</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<span class="w">    </span><span class="o">~</span><span class="n">TooLongWaitingForLock</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//nothing to serialize/deserialize here</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="nf">Serialize</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">[],</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint16_t</span><span class="p">)</span><span class="w"> </span><span class="k">const</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="nf">Deserialize</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="p">[],</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint16_t</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">ToString</span><span class="p">(</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">visitor</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">actualValue</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">maxValue</span><span class="p">)</span><span class="w"> </span><span class="k">const</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">visitor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">&quot;It took suspiciously long to acquire a critical section&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="n">visitor</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Format</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">&quot;, value %&quot;</span><span class="w"> </span><span class="n">PRId64</span><span class="w"> </span><span class="s">&quot; [ms], max allowed %&quot;</span><span class="w"> </span><span class="n">PRId64</span><span class="w"> </span><span class="s">&quot; [ms]&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">actualValue</span><span class="p">,</span><span class="w"> </span><span class="n">maxValue</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">DefaultWarningBound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="p">};</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">DefaultReportBound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="p">};</span>
<span class="p">};</span>
</code></pre></div>
<h2 id="from-a-macro-to-an-output">From a macro to an output</h2>
<p>Now, let us delve into how the MessageControl plugin manages the messages from logging, tracing, and warning reporting. To begin, let us revisit the macros discussed earlier. When handling tracing and logging messages, the first step involves checking if the corresponding category is enabled. Subsequently, both tracing and logging macros create an object of the <code>CATEGORY</code> class, which encapsulates the actual contents of the message provided as <code>PARAMETERS</code> within the macro. This enables the convenient storage and processing of the message content.</p>
<p>However, the approach differs for warning reporting messages. As we previously discussed, the content of a warning reporting message is derived from the <code>ToString()</code> method implemented in the respective warning reporting category class. Instead of creating an object for the message content, the MessageControl plugin retrieves the message content from the <code>ToString()</code> method, which returns the formatted string representation of the warning.</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define TRACE_GLOBAL(CATEGORY, PARAMETERS)</span>
<span class="w">    </span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">using</span><span class="w"> </span><span class="n">__control__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRACE_CONTROL</span><span class="p">(</span><span class="n">CATEGORY</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">__control__</span><span class="o">::</span><span class="n">IsEnabled</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">CATEGORY</span><span class="w"> </span><span class="n">__data__</span><span class="w"> </span><span class="n">PARAMETERS</span><span class="p">;</span>
<span class="w">            </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="w"> </span><span class="nf">__info__</span><span class="p">(</span>
<span class="w">                </span><span class="n">__control__</span><span class="o">::</span><span class="n">Metadata</span><span class="p">(),</span>
<span class="w">                </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Time</span><span class="o">::</span><span class="n">Now</span><span class="p">().</span><span class="n">Ticks</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">            </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">IStore</span><span class="o">::</span><span class="n">Tracing</span><span class="w"> </span><span class="nf">__trace__</span><span class="p">(</span>
<span class="w">                </span><span class="n">__info__</span><span class="p">,</span>
<span class="w">                </span><span class="n">__FILE__</span><span class="p">,</span>
<span class="w">                </span><span class="n">__LINE__</span><span class="p">,</span>
<span class="w">                </span><span class="n">__FUNCTION__</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">            </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">TextMessage</span><span class="w"> </span><span class="nf">__message__</span><span class="p">(</span><span class="n">__data__</span><span class="p">.</span><span class="n">Data</span><span class="p">());</span>
<span class="w">            </span><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageUnit</span><span class="o">::</span><span class="n">Instance</span><span class="p">().</span><span class="n">Push</span><span class="p">(</span><span class="n">__trace__</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">__message__</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span>
</code></pre></div>
<p>In tracing, you may recall that the module name indicates the originating plugin from which the traces originate. To obtain the module name for tracing purposes, the <code>TRACE_CONTROL</code> macro is invoked. This macro plays a crucial role in capturing the module name associated with the trace. However, in logging, the module name is simply set as <code>Syslog</code> without the need for a dedicated macro, and similarly, in warning reporting, the module name is set as <code>Reporting</code>. This provides a standardized module name for all logging and warning reporting messages.</p>
<div class="highlight"><pre><span></span><code><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">MODULE_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">&quot;SysLog&quot;</span><span class="p">);</span>
<span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">MODULE_REPORTING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">&quot;Reporting&quot;</span><span class="p">);</span>
</code></pre></div>
<p>Next, an object of <code>MessageInfo</code> class is created that stores the metadata and time of the message. This provides essential information for further handling and analysis of the message. Then, the last and the most complex part of the message is built, and it is slightly different for tracing, logging and warning reporting. File, line and a name of a class or a function for global trace version are passed as the members of the <code>Tracing</code> class. On the other hand, there are no additional data like this for logging, and for warning reporting there is only a callsign.</p>
<p>In addition to the part of the macros where the messages are formed, the crucial part to which we want to pay extra attention are these two lines:</p>
<div class="highlight"><pre><span></span><code><span class="n">WPEFramework</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">TextMessage</span><span class="w"> </span><span class="nf">__message__</span><span class="p">(</span><span class="n">__data__</span><span class="p">.</span><span class="n">Data</span><span class="p">());</span>
<span class="n">WPEFramework</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageUnit</span><span class="o">::</span><span class="n">Instance</span><span class="p">().</span><span class="n">Push</span><span class="p">(</span><span class="n">__trace__</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">__message__</span><span class="p">);</span>
</code></pre></div>
<h3 id="messageunitpush">MessageUnit::Push()</h3>
<p>This is how the communication between Thunder and the <code>MessageControl</code> plugin takes place. For tracing and logging it is within the macros, but for warning reporting it is in the separate method <code>ReportWarningEvent()</code> of the reporting proxy <code>WarningReportingUnit</code>.  The first step involves constructing the content of the message. Once the message content is prepared, it is then pushed to a buffer or special queue in the second line of code. This buffer serves as a centralized storage for messages, ensuring that they are properly organized and ready for further processing.</p>
<div class="highlight"><pre><span></span><code><span class="cm">/* virtual */</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">MessageUnit::Push</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="o">&amp;</span><span class="w"> </span><span class="n">messageInfo</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">IEvent</span><span class="o">*</span><span class="w"> </span><span class="n">message</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">//logging messages can happen in Core, meaning, otherside plugin can be not started yet</span>
<span class="w">    </span><span class="c1">//those should be just printed</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_settings</span><span class="p">.</span><span class="n">IsDirect</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_direct</span><span class="p">.</span><span class="n">Output</span><span class="p">(</span><span class="n">messageInfo</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_dispatcher</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">serializationBuffer</span><span class="p">[</span><span class="n">DataSize</span><span class="p">];</span>
<span class="w">        </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">        </span><span class="n">ASSERT</span><span class="p">(</span><span class="n">messageInfo</span><span class="p">.</span><span class="n">Type</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">Metadata</span><span class="o">::</span><span class="n">type</span><span class="o">::</span><span class="n">INVALID</span><span class="p">);</span>

<span class="w">        </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">messageInfo</span><span class="p">.</span><span class="n">Serialize</span><span class="p">(</span><span class="n">serializationBuffer</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">serializationBuffer</span><span class="p">));</span>

<span class="w">        </span><span class="c1">//only serialize message if the information could fit</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">length</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">length</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">message</span><span class="o">-&gt;</span><span class="n">Serialize</span><span class="p">(</span><span class="n">serializationBuffer</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">serializationBuffer</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">length</span><span class="p">);</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_dispatcher</span><span class="o">-&gt;</span><span class="n">PushData</span><span class="p">(</span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">serializationBuffer</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">ERROR_NONE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">TRACE_L1</span><span class="p">(</span><span class="s">&quot;Unable to push message data!&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">TRACE_L1</span><span class="p">(</span><span class="s">&quot;Unable to push data, buffer is too small!&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>When the <code>MessageControl</code> plugin is used, each message is buffered and added to a queue. The ultimate destination of these messages depends on the specific configuration settings applied to the plugin. The code segment above is responsible for pushing messages of any type and their associated information to the buffer.</p>
<p>It is important to note that when the <code>MessageControl</code> plugin is not actively running or in scenarios where it is disabled, there is an option to directly print the message onto the console using the <code>DirectOutput()</code> method. This allows for immediate display of the message on the console without going through the buffering process.</p>
<h3 id="messageclientpopmessagesandcall">MessageClient::PopMessagesAndCall()</h3>
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">MessageHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">ProxyType</span><span class="o">&lt;</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="o">&gt;&amp;</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">ProxyType</span><span class="o">&lt;</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">IEvent</span><span class="o">&gt;&amp;</span><span class="p">)</span><span class="o">&gt;</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">MessageClient::PopMessagesAndCall</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MessageHandler</span><span class="o">&amp;</span><span class="w"> </span><span class="n">handler</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_adminLock</span><span class="p">.</span><span class="n">Lock</span><span class="p">();</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">_clients</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">_readBuffer</span><span class="p">);</span>

<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="n">second</span><span class="p">.</span><span class="n">PopData</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">_readBuffer</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">ERROR_READ_ERROR</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">ASSERT</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">_readBuffer</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">_readBuffer</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">Metadata</span><span class="o">::</span><span class="n">type</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">Metadata</span><span class="o">::</span><span class="n">type</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_readBuffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="w">            </span><span class="n">ASSERT</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">Metadata</span><span class="o">::</span><span class="n">type</span><span class="o">::</span><span class="n">INVALID</span><span class="p">);</span>

<span class="w">            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">            </span><span class="n">ASSERT</span><span class="p">(</span><span class="n">handler</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>

<span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">factory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_factories</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">factory</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">_factories</span><span class="p">.</span><span class="n">end</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Core</span><span class="o">::</span><span class="n">ProxyType</span><span class="o">&lt;</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="o">&gt;</span><span class="w"> </span><span class="n">metadata</span><span class="p">;</span>
<span class="w">                </span><span class="n">Core</span><span class="o">::</span><span class="n">ProxyType</span><span class="o">&lt;</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">IEvent</span><span class="o">&gt;</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>

<span class="w">                </span><span class="n">metadata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factory</span><span class="o">-&gt;</span><span class="n">second</span><span class="o">-&gt;</span><span class="n">GetMetadata</span><span class="p">();</span>
<span class="w">                </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factory</span><span class="o">-&gt;</span><span class="n">second</span><span class="o">-&gt;</span><span class="n">GetMessage</span><span class="p">();</span>

<span class="w">                </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">metadata</span><span class="o">-&gt;</span><span class="n">Deserialize</span><span class="p">(</span><span class="n">_readBuffer</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
<span class="w">                </span><span class="n">length</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">message</span><span class="o">-&gt;</span><span class="n">Deserialize</span><span class="p">((</span><span class="o">&amp;</span><span class="n">_readBuffer</span><span class="p">[</span><span class="n">length</span><span class="p">]),</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">length</span><span class="p">));</span>

<span class="w">                </span><span class="n">handler</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">client</span><span class="p">.</span><span class="n">second</span><span class="p">.</span><span class="n">FlushDataBuffer</span><span class="p">();</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">_readBuffer</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">_adminLock</span><span class="p">.</span><span class="n">Unlock</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p>Once the <code>MessageControl</code> plugin receives a notification through its interface after receiving a doorbell ring (after the <code>WaitForUpdated()</code> function),  it proceeds to retrieve the messages from the buffers by calling the <code>PopMessagesAndCall()</code> method from the <code>MessageClient</code> component. After gathering the messages, the <code>MessageControl</code> plugin proceeds to send them to their designated destinations, which is accomplished by invoking the <code>Message()</code> method provided by the plugin.</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">Dispatch</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_client</span><span class="p">.</span><span class="n">WaitForUpdates</span><span class="p">(</span><span class="n">Core</span><span class="o">::</span><span class="n">infinite</span><span class="p">);</span>

<span class="w">    </span><span class="n">_client</span><span class="p">.</span><span class="n">PopMessagesAndCall</span><span class="p">([</span><span class="k">this</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">ProxyType</span><span class="o">&lt;</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">ProxyType</span><span class="o">&lt;</span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">IEvent</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Turn data into piecies to trasfer over the wire</span>
<span class="w">        </span><span class="n">Message</span><span class="p">(</span><span class="o">*</span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="o">-&gt;</span><span class="n">Data</span><span class="p">());</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}</span>
</code></pre></div>
<p>It is important to note that if the <code>MessageControl</code> plugin is disabled, the message queue will eventually reach its capacity. As a result, the framework will issue warnings indicating that there is no more space available in the queue. In this situation, older messages will be overwritten by newer ones as they continue to arrive. Within the <code>Message()</code> method, as shown below, the plugin is responsible for sending the message to all designated outputs selected in the plugin configuration.</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">Message</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="o">&amp;</span><span class="w"> </span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// Time to start sending it to all interested parties...</span>
<span class="w">    </span><span class="n">_outputLock</span><span class="p">.</span><span class="n">Lock</span><span class="p">();</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">_outputDirector</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">entry</span><span class="o">-&gt;</span><span class="n">Message</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">_webSocketExporter</span><span class="p">.</span><span class="n">Message</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>

<span class="w">    </span><span class="n">_outputLock</span><span class="p">.</span><span class="n">Unlock</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="output-configuration">Output configuration</h3>
<p>Let us take a closer look at how outputs are configured and how this configuration can be modified. The configuration is generated as a JSON file, where specific JSON values correspond to the actual objects in the code. The association between an object and its corresponding JSON value is established within the constructor of the <code>Config</code> class in <code>ThunderNanoServicesRDK/MessageControl/MessageControl.h</code> utilizing the <code>Add()</code> method. This connection ensures that the configuration values in the JSON file are correctly linked to the corresponding objects in the code. To understand the configuration process in more detail, it is important to examine the <code>Initialize()</code> method in <code>MessageControl/MessageControl.cpp</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">service</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(((</span><span class="n">_config</span><span class="p">.</span><span class="n">SysLog</span><span class="p">.</span><span class="n">IsSet</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">_config</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">IsSet</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">false</span><span class="p">))</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">_config</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">Value</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Announce</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Publishers</span><span class="o">::</span><span class="n">ConsoleOutput</span><span class="p">(</span><span class="n">abbreviate</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>
<p>Following the configuration reading and the verification of a successful plugin start, there are four conditional statements where the <code>Announce()</code> methods are called. Let us consider an example where the system is running in the foreground, syslog and console outputs are not yet set, but console output has been enabled in the configuration. In this scenario, the <code>Announce()</code> method is invoked with a new object of the <code>Publishers::ConsoleOutput</code> class. This can be observed in the provided listing. Additionally, the class constructor takes as a parameter whether the message should be abbreviated or not.</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">Announce</span><span class="p">(</span><span class="n">Publishers</span><span class="o">::</span><span class="n">IPublish</span><span class="o">*</span><span class="w"> </span><span class="n">output</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_outputLock</span><span class="p">.</span><span class="n">Lock</span><span class="p">();</span>

<span class="w">    </span><span class="n">ASSERT</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">find</span><span class="p">(</span><span class="n">_outputDirector</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">_outputDirector</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"> </span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">_outputDirector</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>

<span class="w">    </span><span class="n">_outputDirector</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">output</span><span class="p">);</span>

<span class="w">    </span><span class="n">_outputLock</span><span class="p">.</span><span class="n">Unlock</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p>Let us examine the <code>Announce()</code> method and then investigate the <code>ConsoleOutput</code> class. In the code listing above, we can notice that the methodâ€™s body is inside a lock, so that we can be sure that there will be no concurrency issues. The crucial part is the <code>_outputDirector</code> vector of pointers for the <code>Publishers::IPublish</code> objects. First, we make sure that an object passed as a method parameter is not already present in this vector, and then add it to the list. In the above list, the <code>Announce()</code> method takes a new object of the <code>Publishers::ConsoleOutput</code> class as a parameter.</p>
<div class="highlight"><pre><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">IPublish</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">IPublish</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">Message</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="o">&amp;</span><span class="w"> </span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ConsoleOutput</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">IPublish</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">ConsoleOutput</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>
<span class="w">    </span><span class="n">ConsoleOutput</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ConsoleOutput</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>
<span class="w">    </span><span class="n">ConsoleOutput</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ConsoleOutput</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>

<span class="w">    </span><span class="k">explicit</span><span class="w"> </span><span class="n">ConsoleOutput</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="o">::</span><span class="n">abbreviate</span><span class="w"> </span><span class="n">abbreviate</span><span class="p">)</span>
<span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">_convertor</span><span class="p">(</span><span class="n">abbreviate</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="o">~</span><span class="n">ConsoleOutput</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>

<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">Message</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="o">&amp;</span><span class="w"> </span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">text</span><span class="p">);</span>

<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="n">Text</span><span class="w"> </span><span class="n">_convertor</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<p>If you have noticed the connection between the <code>ConsoleOutput</code> and <code>IPublish</code> structures, you are absolutely correct. Within the <code>ThunderNanoServicesRDK/MessageControl/MessageOutput.h</code> file, you will find the <code>IPublish</code> structure along with several classes that inherit from it, including the <code>ConsoleOutput</code> class. The base structure <code>IPublish</code> has a virtual destructor, so that we can ensure that an instance of a derived class will not be potentially deleted through a pointer to the base class. In addition, it also has a virtual method <code>Message()</code> that is overridden in each of the derived classes.</p>
<h3 id="convert-the-final-step">Convert() - the final step</h3>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">ConsoleOutput::Message</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="o">&amp;</span><span class="w"> </span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="cm">/* override */</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">_convertor</span><span class="p">.</span><span class="n">Convert</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">string</span><span class="w"> </span><span class="nf">Text::Convert</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">MessageInfo</span><span class="o">&amp;</span><span class="w"> </span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="cm">/* override */</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">ASSERT</span><span class="p">(</span><span class="n">metadata</span><span class="p">.</span><span class="n">Type</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Messaging</span><span class="o">::</span><span class="n">Metadata</span><span class="o">::</span><span class="n">type</span><span class="o">::</span><span class="n">INVALID</span><span class="p">);</span>

<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">metadata</span><span class="p">.</span><span class="n">ToString</span><span class="p">(</span><span class="n">_abbreviated</span><span class="p">).</span><span class="n">c_str</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">                    </span><span class="n">Core</span><span class="o">::</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">output</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>The final step before the message is sent to the output involves invoking the <code>Convert()</code> method. As demonstrated in the above code listing, this method is responsible for constructing a string that combines the metadata, formatted according to the specific message type, with the actual text of the message. The resulting string represents a comprehensive representation of the message ready for output. For instance, this is how the <code>ToString()</code> method looks like for tracing type messages:</p>
<div class="highlight"><pre><span></span><code><span class="n">string</span><span class="w"> </span><span class="nf">IStore::Tracing::ToString</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">abbreviate</span><span class="w"> </span><span class="n">abbreviate</span><span class="p">)</span><span class="w"> </span><span class="k">const</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Time</span><span class="w"> </span><span class="n">now</span><span class="p">(</span><span class="n">TimeStamp</span><span class="p">());</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">abbreviate</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">abbreviate</span><span class="o">::</span><span class="n">ABBREVIATED</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">time</span><span class="p">(</span><span class="n">now</span><span class="p">.</span><span class="n">ToTimeOnly</span><span class="p">(</span><span class="nb">true</span><span class="p">));</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;[%s]:[%s]:[%s]: &quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">time</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span>
<span class="w">                </span><span class="n">Module</span><span class="p">().</span><span class="n">c_str</span><span class="p">(),</span>
<span class="w">                </span><span class="n">Category</span><span class="p">().</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">time</span><span class="p">(</span><span class="n">now</span><span class="p">.</span><span class="n">ToRFC1123</span><span class="p">(</span><span class="nb">true</span><span class="p">));</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Core</span><span class="o">::</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;[%s]:[%s]:[%s:%u]:[%s]:[%s]: &quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">time</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span>
<span class="w">                </span><span class="n">Module</span><span class="p">().</span><span class="n">c_str</span><span class="p">(),</span>
<span class="w">                </span><span class="n">Core</span><span class="o">::</span><span class="n">FileNameOnly</span><span class="p">(</span><span class="n">FileName</span><span class="p">().</span><span class="n">c_str</span><span class="p">()),</span>
<span class="w">                </span><span class="n">LineNumber</span><span class="p">(),</span>
<span class="w">                </span><span class="n">ClassName</span><span class="p">().</span><span class="n">c_str</span><span class="p">(),</span>
<span class="w">                </span><span class="n">Category</span><span class="p">().</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>In summary, the output of messages within Thunder is determined by the list of listeners stored in the <code>_outputDirector</code> container. This list is populated through successive calls to the <code>Announce()</code> method, which can occur multiple times during the initialization of the <code>MessageControl</code> plugin, depending on the configuration. Each call to the <code>Announce()</code> method adds a new output listener to the <code>_outputDirector</code> list, configuring the desired destinations for message delivery.</p>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../versioning/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Versioning" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Versioning
              </div>
            </div>
          </a>
        
        
          
          <a href="../subsystems/" class="md-footer__link md-footer__link--next" aria-label="Next: Subsystems" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Subsystems
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer", "navigation.sections", "toc.follow", "navigation.top", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>